$(function(){$(".fixed-action-btn").click(function(){var t=$("#modal-create");t.find("#create-name").val(""),t.find("#create-description").val(""),t.find("#create-public").prop("checked",!0),t.openModal()});var t=new function(){this.count=0,this.defaultImg='<div class="icon"><i class="mdi-action-event"></i></div>',this.$columns=[$("#col1"),$("#col2"),$("#col3")],this.add=function(t,i,a){var s='<img src="'+a+'"/>';void 0===a&&(s=this.defaultImg),this.$columns[this.count%3].append('<div class="card small waves-effect waves-light"><div class="card-image fill-card">'+s+'<span class="card-title">'+t+"</span></div></div>").data("id",i).click(function(){e.show($(this).data("id"))}),this.count++},this.clear=function(){this.count=0,this.$columns.forEach(function(t){t.empty()})}},e=new function(){var t=this;this.$modal=$("#modal-event"),this.$more=$("#modal-more"),this.$organizers=this.$modal.find("#event-organizers .col"),this.ocount=0,this.$participants=this.$modal.find("#event-participants .col"),this.pcount=0,this.$channels=this.$modal.find("#event-channels .col"),this.ccount=0,this.$submit=this.$modal.find("#submit-event"),this.id=void 0,this.favorite=!1,this.participants=["Bob","Tom","Odd"],this.isOrganizer=!1,this.$submit.click(function(){t.toggle()}),this.$modal.find("#event-more").click(function(){t.showMore()}),this.$modal.find("#event-channels").find(".channel").click(function(){console.log("clicked channel"),console.log($(this).find("input").is(":checked")),console.log($(this).text());var e=$("body").append('<img src="/qr/'+t.id+"/"+$(this).text().toLowerCase()+'" class="materialboxed"/>');e.materialbox(),e.click(),e.click(function(){e.remove()})}),this.show=function(e){this.id=e;var i=this,a=new XMLHttpRequest;a.onload=function(){if(200!=this.status)Materialize.toast(this.responseText,4e3);else{var e=JSON.parse(a.responseText);if(e.ok){i.setTitle(e.name),i.setDescription(e.description||"<p style='opacity: .54;'>No description.</p>");for(var s=0;s<e.organizers.length;s++)i.addOrganizer(e.organizers[s]);for(var s=0;s<e.participants.length;s++)i.addParticipant(e.participants[s]);i.favorite=!0,i.$submit.text("Remove"),t.isOrganizer=e.organizers.indexOf($.cookie("phone"))>=0,i.$modal.openModal()}else Materialize.toast("Request failed: "+e.reason,4e3)}},a.open("GET","/event/:handle&slug="+this.id,!0),a.setRequestHeader("Content-Type","application/json"),a.send()},this.setTitle=function(t){$("#event-title").text(t)},this.setDescription=function(t){$("#event-description").text(t)},this.addOrganizer=function(t,e){e=void 0===e?'<i class="mdi-action-account-circle"></i>':'<img src="'+e+'" />',$(this.$participants[this.ocount]).append('<div class="participant">'+e+"<span>"+t+"</span></div>"),this.ocount=(this.ocount+1)%2},this.addParticipant=function(t,e){e=void 0===e?'<i class="mdi-action-account-circle"></i>':'<img src="'+e+'" />',$(this.$participants[this.pcount]).append('<div class="participant">'+e+"<span>"+t+"</span></div>"),this.pcount=(this.pcount+1)%3},this.addChannel=function(t,e){$(this.$channels[this.ccount]).append("<div><span>"+t+'</span><div class="switch" style="float: right"><label><input type="checkbox"'+(e?'checked="checked"':"")+'><span class="lever"></span></label></div></div>'),this.ccount=(this.ccount+1)%3},this.toggle=function(){console.log(this.id),this.$submit.text(this.favorite?"Add":"Remove"),this.favorite=!this.favorite},this.showMore=function(){this.$modal.closeModal(),setTimeout(function(){t.$more.openModal({complete:function(){setTimeout(function(){t.$modal.openModal()},100)}})},300),$("#more-title").text($("#event-title").text()),$("#more-description").text($("#event-description").text());for(var e=function(t){for(var e=t.length,i,a;e;)a=Math.floor(Math.random()*e--),i=t[e],t[e]=t[a],t[a]=i;return t},i={teams:[],results:[]},a=e(this.participants),s=0;s<a.length;s+=2)s+1===a.length?(i.teams.push([a[s],"N/A"]),i.results.push([0,-1])):(i.teams.push([a[s],a[s+1]]),i.results.push([void 0,void 0]));var n=function(){};$("#more-bracket").bracket({init:i,save:n})}};e.addParticipant("hi"),e.addChannel("hi again");var i=function(){var e=new XMLHttpRequest;e.onload=function(){if(200!=this.status)Materialize.toast(this.responseText,4e3);else{var i=JSON.parse(e.responseText);if(i.ok)for(var a=0;a<i.events.length;a++)t.add(i.events[a].name,i.events[a].slug,i.events[a].image);else Materialize.toast("Request failed: "+i.reason,4e3)}},e.open("GET","/event/listall",!0),e.send()};i(),t.add("Smash Tourney","test-id"),t.add("Amaze","amazing-race"),$("#create-form").submit(function(t){t.preventDefault();for(var e=$(this).serializeArray(),i={},a=0;a<e.length;a++)i[e[a].name]=e[a].value;var s=new XMLHttpRequest;s.onload=function(){if(200!=this.status)Materialize.toast(this.responseText,4e3);else{var t=JSON.parse(this.responseText);t.ok?(Materialize.toast("Event created.",4e3),$("#modal-create").closeModal()):Materialize.toast("Request failed: "+t.reason,4e3)}},s.open("POST","/event/new",!0),s.setRequestHeader("Content-Type","application/json"),s.send(JSON.stringify(i))}),$("#create-event").click(function(){$("#create-form").trigger("submit")}),$("#create-name").bind("change paste input keyup",function(){$(this).data("previous")||$(this).data("previous",""),$("#create-slug").val()==$(this).data("previous").toLowerCase().replace(/\s+/g,"-").replace(/[^A-Za-z0-9-]/g,"")&&$("#create-slug").val($(this).val().toLowerCase().replace(/\s+/g,"-").replace(/[^A-Za-z0-9-]/g,"")),$(this).data("previous",$(this).val())}),$("#new-channel").click(function(){$("#modal-event").closeModal(),setTimeout(function(){$("#modal-add-channel").openModal()},300)})});